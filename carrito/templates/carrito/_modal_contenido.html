{% if items %}
  <div class="list-group">
    {% for item in items %}
      <div class="list-group-item d-flex align-items-center justify-content-between">
        <!-- Columna izquierda: imagen + datos -->
        <div class="d-flex align-items-center gap-3">
          {% if item.producto.imagen %}
            <img src="{{ item.producto.imagen.url }}" alt="{{ item.producto.nombre }}"
                 width="48" height="48" class="rounded border">
          {% else %}
            <div class="bg-light border rounded d-flex align-items-center justify-content-center"
                 style="width:48px; height:48px;">
              <i class="bi bi-box text-muted"></i>
            </div>
          {% endif %}
          <div>
            <div class="fw-semibold">{{ item.producto.nombre }}</div>
            <small class="text-muted">Subtotal: ${{ item.subtotal|floatformat:0 }}</small>
          </div>
        </div>

        <!-- Columna derecha: controles de cantidad -->
        <div class="d-flex align-items-center gap-2">
          <!-- Botón restar -->
          <form method="post" action="{% url 'disminuir_cantidad' item.id %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-secondary" title="Disminuir">
              <i class="bi bi-dash"></i>
            </button>
          </form>

          <!-- Cantidad -->
          <span class="fw-semibold">{{ item.cantidad }}</span>

          <!-- Botón sumar -->
          <form method="post" action="{% url 'aumentar_cantidad' item.id %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-secondary" title="Aumentar">
              <i class="bi bi-plus"></i>
            </button>
          </form>

          <!-- Botón eliminar -->
          <form method="post" action="{% url 'eliminar_del_carrito' item.id %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-danger" title="Eliminar">
              <i class="bi bi-trash"></i>
            </button>
          </form>
        </div>
      </div>
    {% endfor %}
  </div>

  <div class="d-flex justify-content-between align-items-center mt-3">
    <span class="fw-semibold">Total</span>
    <span class="fs-5 fw-bold">${{ total|floatformat:0 }}</span>
  </div>
{% else %}
  <div class="text-center py-5">
    <i class="bi bi-cart-x fs-1 text-muted"></i>
    <p class="mt-3 mb-0">Tu carrito está vacío.</p>
  </div>
{% endif %}
